from sage.all import *
from isogenies.Kani_clapoti import KaniClapotiIsog
from theta_structures.Tuple_point import TuplePoint
from time import time

proof.all(False)

# Parameters
p = 864175120484581453683482079962486176185193500155369104423588921177379322250834082489183304374038697487834084609675858746433355728113743766078731283595263
Fp = GF(p)
Fp2 = GF((p,2), name='i', modulus=var('x')**2 + 1)  
i = Fp2.gens()[0]

# Elliptic curves
Au = 1891859883683638786908291984827613832083440533897660509059048203921076252184808250031089406423917979367363123626160061980307590151065184234494601949752
Av = 230188940872321764125851119718921582314831297899450233204043730409581420489721496234255705928788156753757949517375709468983016348086447635211363357283396

Eu = EllipticCurve(Fp2,[0,Au,0,1,0])
Ev = EllipticCurve(Fp2,[0,Av,0,1,0])


# Basis points
Pux = 654108255784945102376950955592110536477018808527731331676140941969772423296099075064379374066921438478906489385643616854636718887288635310843852641486576*i + 391174870325831136553854948007686226897420952250827223721761035262156280757652230245370207815983523471753160219662787021213043701803765784894002229748667
Puy = 552330793078138015871161334684964447776593692558685217601957537874815248116372803603583986866675267757741603679040961454346334096450175679518022568343687*i + 856907297862553627707963988284553091215912640639259979503580429369563434185981584965787714393569682364617545610444700809953494654869219925304135816611611

Qux = 426264586468985513693380482043543735221266167857966211405117073269092825553360803600235865761139598060404317731487259526490230927525508024098908279252852*i + 19919190017311523633925108925981542016891639454804897728691806311861565569574527018951326956580134259324973977720005565178645549695579458076932678469589
Quy = 822776643414587380914705275619028262840506101040371604977313005820254958455340940312392447958940754727604368616248524732110686171624334123194932152726778*i + 387577971898262380593347627016167928467906356857688479746507238389139249852371368435838854369038113651551987895534737551856997217828257243739398691314749

Pvx = 241073220959247533965376045748421475056572693252835741913301872422999510763284912279672405161808724316108227153781040077839608884001338845056555900394203*i + 65564751838957371867875027158145902557431564905176552202266006386173158415621341476142173310997346952706150301358938472482645109913860448980938567414533
Pvy = 408188110112789117700710101386245327351602607653738609570422006297247070581631875376179615369230899252562765111085395472556929750754943388109470602613952*i + 130300877605326644022257878166802817497371237078215048696967899890175418490643892058572314825012270204026007539546547467332269895446146410708090964684784

Qvx = 518412298553133857457846083283798238249097816780958445209486974358898372198622346762622262643402622712768253249355026017147012163082875617825936347216810*i + 604235506806115782476636712073935487887870367580453464766216366940651649289537061544359118522975036029587052801723710125801773059973809166256291759326641
Qvy = 719750424891680903682252884756653497415416776235621317822418231831637273866229952822249654563612425781787434607846938148806335125848171170943302922883015*i + 723636662743953371398784479934189966164310534059073962050255396474474309069170704733385998488627841563025211807401476761705726188424598228718709395436053

Pu=Eu((Pux,Puy))
Qu=Eu((Qux,Quy))

Pv=Ev((Pvx,Pvy))
Qv=Ev((Qvx,Qvy))

# Integers
N1=442635731796067302071575229275823449782130647495783615826212141159355007789
N2=104675785728111373761689781882317824392062335106507720168062574593140424403
x_u=17166650841073979646995861196182096446 
y_u=55143203311592217891089982520372955099 
g_u=1 
x_v=27653693810100738079602922657790009698 
y_v=218344261261220535971272507863274042597 
g_v=1
t=501

if __name__=="__main__":
	t1=time()
	F = KaniClapotiIsog([Pu,Qu,Pv,Qv],[g_u,x_u,y_u,g_v,x_v,y_v,N1,N2,t])
	FP1 = F(TuplePoint([Pu,Eu(0),Ev(0),Ev(0)]))
	FP2 = F(TuplePoint([Pu,Qu,Pv,Qv]))
	FP3 = F(TuplePoint([Eu(0),Eu(0),Ev(0),Ev(0)]))
	t2=time()
	print("Time {} s".format(t2-t1))

