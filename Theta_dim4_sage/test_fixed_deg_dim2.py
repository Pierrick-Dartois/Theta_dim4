from sage.all import *

from isogenies.Kani_fixed_deg_dim2 import KaniFixedDegDim2
from theta_structures.Tuple_point import TuplePoint
from utilities.supersingular import torsion_basis_2f_frobenius

params = {'500':{
'c':33,
'e':503,
'comb_bound':10,
'A': 846923981206860774667188923127927404866138431504857441785556155002892474407686465068998563030997400041497236660113832719116298437902864009587446028542241 #Starting curve
},
'1000':{
'c':15,
'e':1004,
'comb_bound':10,
'A': 2447932165031884901753526747235802754200581132492013990029309589916334680445261935406178846882142279733036010435356728900482083533977052489550706097041090570437350041707592382243329641233414772511433265807801169694848478362818691704488235495552842938554477902999119670514198118427921959251521459174283757
},
'1500':{
'c':9,
'e':1551,
'comb_bound':10,
'A':239802879539317202964344040529317992128417165433825470485593880365658460807026777409884801479544885436570659544978636275610563767973013516301362886603599904499306712409027539675608967850192889711996265069137002199690868424078112092323648323642273105115715944156673967552633489796454447031902047740284147330474607688233022949266746179912106856502540282132812177336835309626451964574576585392008375734585277061951255596956979771764693710005089216314976689439791667676420
},
'2000':{
'c':51,
'e':2026,
'comb_bound':15,
'A':65238494637238242582733319520600381817936029612561531261832098617696422736546453202654468912205382623923831922522659717912873676057924067217679865762441883814162357307024198885642286962040019617566175973803173073379804470719404894173220287321386387102179331130399981798896761506920116494956430129843884928325069879684376441212993883950290080281222669337807902520124575983909349260932602509076912500324737124594208309322202641338433752444276214485208755424882812550549968588285733081389186946720799097279892398873782265313272427493716633883075870913574592288678169655481756997394911493186896514342173715256463713
},
'4000':{
'c':63,
'e':4084,
'comb_bound':30,
'A':13415390464477145446815281583553323109483358453356258625564898240022047002772859721121947605043685940738392619751711118389508001715375236292865857390998227548634481915410729807319653232619581874634782498034932223622264524601411796669606972268474609287123954829875779991184336009032139639033980028432872223758747884462205908894397817828557227341832343506373815290231013491897869072238475451113150173861952815892196799686342257617677500270408211748968373342130830837298698258958091288993430624823357518883072829741603545242908079067915737134979179480322591457699378012745212186468542603148846757376388958212880118237320738106811751768974673983478491294981706778141085148769496267726290183010031488188228963503515638179614566865033081941833750330636758927263380925045954446502479425375335662388846397639093688784606985710336429826025815643693289079704705983680452626546782554712093231016691553099718353949315733616058961875832876501826019808769336638458811814310649375229679632977068398309189880998097736223885569440842266910291568853474902053997012155808679583074523270231251350171818737539360290416262797884480867146901345080841908283160848525456284793139917857602017444128002169647765764875095115486156948204973881103480835920552854
}}

lvl = '500'

def test_fixed_deg_dim2(lvl):
	c = params[lvl]['c']
	e = params[lvl]['e']
	A = params[lvl]['A']

	p=c*2**e-1
	Fp2=GF(p**2,name='i',modulus=[1,0,1],proof=False)

	E=EllipticCurve(Fp2,[0,A,0,1,0])

	u=2*randint(0,ceil(sqrt(p)/2))+1

	P, Q = torsion_basis_2f_frobenius(E,e-1)

	Phi_u = KaniFixedDegDim2(u,E,[P,Q])

	Phi_u_P = Phi_u(TuplePoint(P,0))


if __name__=="__main__":
	test_fixed_deg_dim2(lvl)
